{%- liquid
  # Build a template class based on the product's assigned template
  assign tpl_class = 'product-template-default'
  if product.template_suffix != blank
    assign tpl_class = 'product-template-' | append: product.template_suffix
  endif
-%}

<div class="grid-item {{ tpl_class }}">
  <div class="image-wrapper">
    <div class="product-card {{ tpl_class }}">
      <a href="{{ product.url }}" class="product-card__link">
        <div class="product-card__image-container">
          <div class="product-card__image with-frame with-matte">
            {% if product.featured_image %}
              {{ product.featured_image 
                | image_url: width: 1200 
                | image_tag: class: 'full-image'
              }}
            {% else %}
              <img src="https://media.istockphoto.com/id/485371557/photo/twilight-at-spirit-island.jpg?s=612x612&w=0&k=20&c=FSGliJ4EKFP70Yjpzso0HfRR4WwflC6GKfl4F3Hj7fk=" alt="PLACEHOLDER">
            {% endif %}
          </div>
        </div>

        <div class="product-card__info {% if swym_enabled %}swym-enabled{% endif %}">
          {%- liquid
            assign location_text = product.metafields.custom.location
            assign collection_title = ''
            if collection and collection.title != blank
              assign collection_title = collection.title
            elsif product.collections and product.collections.size > 0
              assign collection_title = product.collections.first.title
            endif
          -%}

          <div class="product-card__meta-list">
            {%- if collection_title != blank -%}
              <span class="product-meta__item product-meta__collection">{{ collection_title | escape }}</span>
            {%- endif -%}

            {%- if location_text != blank -%}
              <span class="product-meta__item product-meta__location hide-mob">{{ location_text | escape }}</span>
            {%- endif -%}

            <span class="product-meta__item product-card__title">“{{ product.title | escape }}”</span>
          </div>

          {% if swym_enabled %}
            <button 
              aria-label="Add to Wishlist" 
              data-with-epi="true" 
              class="swym-button swym-add-to-wishlist-view-product product_{{ product.id }}" 
              data-swaction="addToWishlist" 
              data-product-id="{{ product.id | json }}" 
              data-variant-id="{{ product.variants[0].id }}" 
              data-product-url="{{ shop.url }}{{ product.url }}">
            </button>
          {% endif %}
        </div>
      </a>
    </div>
  </div>
</div>
